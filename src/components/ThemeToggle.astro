---
// src/components/ThemeToggle.astro
---
<div class="flex items-center space-x-2">
    <label for="theme-toggle" class="text-gray-700 dark:text-gray-300 text-sm">Modo Oscuro</label>
    <label class="switch">
        <input type="checkbox" id="theme-toggle">
        <span class="slider"></span>
    </label>
</div>

<style>
    
    .switch {
        position: relative;
        display: inline-block;
        width: 50px;
        height: 28px;
    }

    .switch input {
        opacity: 0;
        width: 0;
        height: 0;
    }

    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #cbd5e0; /* gray-300 */
        -webkit-transition: .4s;
        transition: .4s;
        border-radius: 28px;
    }

    .slider:before {
        position: absolute;
        content: "";
        height: 20px;
        width: 20px;
        left: 4px;
        bottom: 4px;
        background-color: white;
        -webkit-transition: .4s;
        transition: .4s;
        border-radius: 50%;
    }

    input:checked + .slider {
        background-color: #2563eb; /* blue-600 */
    }

    input:focus + .slider {
        box-shadow: 0 0 1px #2563eb;
    }

    input:checked + .slider:before {
        -webkit-transform: translateX(22px);
        -ms-transform: translateX(22px);
        transform: translateX(22px);
    }
</style>

<script is:inline>
    // Script de la isla: se ejecuta en el cliente
    const themeToggle = document.getElementById('theme-toggle');

    // Establecer el estado inicial del switch basado en localStorage
    document.addEventListener('DOMContentLoaded', () => {
        if (localStorage.getItem('theme') === 'dark') {
            themeToggle.checked = true;
        } else {
            themeToggle.checked = false;
        }
    });

    // Escuchar cambios en el switch
    themeToggle.addEventListener('change', () => {
        if (themeToggle.checked) {
            document.documentElement.classList.add('dark');
            localStorage.setItem('theme', 'dark');
        } else {
            document.documentElement.classList.remove('dark');
            localStorage.setItem('theme', 'light'); // Guarda 'light' expl√≠citamente
        }
    });
</script>